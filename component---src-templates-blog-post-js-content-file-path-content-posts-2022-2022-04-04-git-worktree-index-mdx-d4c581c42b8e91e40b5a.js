"use strict";(self.webpackChunkmaxpou_fr=self.webpackChunkmaxpou_fr||[]).push([[5623],{6229:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var n=a(1151),r=a(7294);function s(e){const t=Object.assign({p:"p",span:"span",em:"em",h2:"h2",a:"a",ul:"ul",li:"li",strong:"strong"},(0,n.ah)(),e.components);return r.createElement(r.Fragment,null,r.createElement(t.p,null,"A few months ago, I had to do a fix that requires both backend and frontend. I branch off from my\nbackend colleague branch‚Ä¶ In the end, keeping my branch up to date with the ",r.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">main</code>'}})," branch plus my\ncolleague‚Äôs branch ended up being a bit messy (I rebase a lot and my colleagues didn‚Äôt)."),"\n",r.createElement(t.p,null,"I googled something like ",r.createElement(t.em,null,"‚Äúhow to have multiple git branches at the same time‚Äù"),". In one\nStackOverflow post, someone mentioned git worktrees. Something I never heard before!"),"\n",r.createElement(t.h2,{id:"git-worktrees-to-the-rescue",style:{position:"relative"}},r.createElement(t.a,{href:"#git-worktrees-to-the-rescue","aria-label":"git worktrees to the rescue permalink",className:"anchor before"},r.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Git worktrees to the rescue!"),"\n",r.createElement(t.p,null,r.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">git worktrees</code>'}})," allows you to attach a branch to a specific folder. It‚Äôs like doing a clone of a\nrepository that shares the same git folder."),"\n",r.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 42.567567567567565%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB8klEQVR42m2RXUiTcRTGf69re7dYjNba2tyHZWrL9UG4kRcRfd14bXd11V0X3XWxboKwbiSEGcEoFFmJRlSsGVFgRcqCIEJRaOrGdtdNmQ0XbvPE++69WOaBA885/M9znv9zKCZM6yuTVLPDyjTAp8v20cKAKoUnrM09VEqDVwkBu1SV/aBjLQ8CrYDC1pC3XpHPTilMWBe0unDX/lLeeESyrvqPtK2SjHPoCnhOqzqJlp1AG3AY8AEuwG3gPchSVGTphBSn3IsaYf7V7oyUekQWeuqrH9sqQ9fpWu/rC533Oc4BZ01wAYgBRwzydmNBB3CA5Ufq01zK/GI2oQxohO+HWq59S6nplceWybkRy9jgJdzJ5M2d0WhoH+Aw1HiAFraNbgJg87c6bf5T3QTafVqNH6xBwLllUGnyTeubmnqN3Lij/ik/V1Z/T1H+mebWWobv5Qy/Kq+pzY9wQxsKuvACEcO3MHDMqEP/H+VZWKrvAjXJeqU+TaL6wVXZmOnclC9+KU2g2xCbiZ1xXNx7XCey0AX6LzQfTwL2JvUgpbDU5yM1WQyLZEnI145Kfe7opuTDUkqbb2tv4vd7I8GgfpRe7TCGUrvh6Y5/FBbHlQe5MSW5nFKSs/foz6WUYQ3nx5XRVJx+QKXBYAHMgJUG3jb+AgbKqwwz1FcYAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/04c0a82adfd62adca13296251c3564a2/cbe2e/clone-vs-worktree.webp 148w,\n/static/04c0a82adfd62adca13296251c3564a2/3084c/clone-vs-worktree.webp 295w,\n/static/04c0a82adfd62adca13296251c3564a2/5ca24/clone-vs-worktree.webp 590w,\n/static/04c0a82adfd62adca13296251c3564a2/dad35/clone-vs-worktree.webp 885w,\n/static/04c0a82adfd62adca13296251c3564a2/2baf0/clone-vs-worktree.webp 1180w,\n/static/04c0a82adfd62adca13296251c3564a2/b47ac/clone-vs-worktree.webp 1672w"\n              sizes="(max-width: 590px) 100vw, 590px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/04c0a82adfd62adca13296251c3564a2/12f09/clone-vs-worktree.png 148w,\n/static/04c0a82adfd62adca13296251c3564a2/e4a3f/clone-vs-worktree.png 295w,\n/static/04c0a82adfd62adca13296251c3564a2/fcda8/clone-vs-worktree.png 590w,\n/static/04c0a82adfd62adca13296251c3564a2/efc66/clone-vs-worktree.png 885w,\n/static/04c0a82adfd62adca13296251c3564a2/c83ae/clone-vs-worktree.png 1180w,\n/static/04c0a82adfd62adca13296251c3564a2/5b6ee/clone-vs-worktree.png 1672w"\n            sizes="(max-width: 590px) 100vw, 590px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/04c0a82adfd62adca13296251c3564a2/fcda8/clone-vs-worktree.png"\n            alt="git clone vs. git worktree"\n            title=""\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n    </span>'}}),"\n",r.createElement(t.p,null,"Using worktrees also makes the context switching easier. Before that, I used 2 different strategies\nfor context switching:"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"Git clone a new repository. Pulling the ",r.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">.git</code>'}})," folder makes this approach slow. Plus you can‚Äôt\ncherry-pick commits between 2 different clones."),"\n",r.createElement(t.li,null,"Create a wip commit on your actual branch or the plain old ",r.createElement(t.a,{href:"/git-cheat-sheet#stash"},"git stash"),". It\ndoes the job but it can be tedious when your actual branch has too many different dependencies.\nThe git stashes can also be subjects to git conflicts."),"\n"),"\n",r.createElement(t.h2,{id:"how-worktree-works",style:{position:"relative"}},r.createElement(t.a,{href:"#how-worktree-works","aria-label":"how worktree works permalink",className:"anchor before"},r.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"How worktree works?"),"\n",r.createElement(t.p,null,"Let‚Äôs say I want to move this blog from Gatsby to Nextjs. But I want to keep a copy in case I found\na typo somewhere. Using Git worktrees would be the perfect fit."),"\n",r.createElement(t.p,null,"To create a worktree:"),"\n",r.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">git</span> worktree <span class="token function">add</span> <span class="token punctuation">..</span>/nextjs-migration</code></pre></div>'}}),"\n",r.createElement(t.p,null,"If I list my worktree, here‚Äôs what I have:"),"\n",r.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">git</span> worktree list\n/Users/maxence/lab/maxpou.fr         be8e2774 <span class="token punctuation">[</span>main<span class="token punctuation">]</span>\n/Users/maxence/lab/nextjs-migration  be8e2774 <span class="token punctuation">[</span>nextjs-migration<span class="token punctuation">]</span></code></pre></div>'}}),"\n",r.createElement(t.p,null,"We now have 2 folders: ‚Äúmaxpou.fr‚Äù (on branch main) and ‚Äúnextjs-migration‚Äù (on branch\nnextjs-migration)."),"\n",r.createElement(t.p,null,"As I mentioned earlier, these 2 different folders share the same ",r.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">.git</code>'}})," folder and history. If we\ncheck the new folder, it doesn‚Äôt contain a .git folder but a .git file, which only contains this\nline:"),"\n",r.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">gitdir: /Users/maxence/lab/maxpou.fr/.git/worktrees/nextjs-migration</code></pre></div>'}}),"\n",r.createElement(t.p,null,"Now, let‚Äôs forget about this nextjs thing. To delete this worktree (folder+branch), run the\nfollowing:"),"\n",r.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> worktree remove nextjs-migration</code></pre></div>'}}),"\n",r.createElement(t.p,null,"That‚Äôs it! ü•≥"),"\n",r.createElement(t.h2,{id:"good-use-case",style:{position:"relative"}},r.createElement(t.a,{href:"#good-use-case","aria-label":"good use case permalink",className:"anchor before"},r.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Good use case"),"\n",r.createElement(t.p,null,"I‚Äôve been using this feature for the last 3 months. Here‚Äôs a few use case:"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"consequent migrations: I‚Äôve been migrating big migrations to our codebase (changing major npm\nversion and module bundler). Both of these migrations happened in a different worktree."),"\n",r.createElement(t.li,null,"keeping a local version of a specific environment"),"\n",r.createElement(t.li,null,"checking a colleague PR locally (when I don‚Äôt want to git stash or create a wip commit)"),"\n"),"\n",r.createElement(t.p,null,r.createElement(t.strong,null,"üí° NPM Tips:")," ",r.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">npm install</code>'}})," can sometimes be slow. If you only want to install dependencies\nwithout doing any optimizations, I recommend you to install your dependencies with ",r.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">npm ci</code>'}})," (stands\nfor clean install). It‚Äôs much faster!"))}var o=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,n.ah)(),e.components);return t?r.createElement(t,e,r.createElement(s,e)):s(e)},l=a(4222),c=a(418),i=a(4529),d=a(7953),g=a(4849),m=a(5536),h=a(2404);function p(e){let{data:t,pageContext:a,children:n,location:s}=e;const o=t.post,{previous:p,next:u}=a;return r.createElement(l.Z,{location:s},r.createElement(m.Z,{title:o.frontmatter.title,description:o.frontmatter.description||o.excerpt,cover:o.frontmatter.cover&&o.frontmatter.cover.publicURL,imageShare:o.frontmatter.imageShare&&o.frontmatter.imageShare.publicURL,lang:o.frontmatter.language,translations:o.frontmatter.translations,path:o.frontmatter.slug,isBlogPost:!0}),r.createElement(i.Z,{heroImg:o.frontmatter.cover,title:o.frontmatter.title}),r.createElement(c.Z,null,r.createElement(d.Z,{post:o},n)),r.createElement(c.Z,{as:"aside"},r.createElement(h.Z,{slug:o.frontmatter.slug,title:o.frontmatter.title,redditPostId:o.frontmatter.redditPostId})),r.createElement(g.Z,{previous:p,next:u}))}function u(e){return r.createElement(p,e,r.createElement(o,e))}}}]);
//# sourceMappingURL=component---src-templates-blog-post-js-content-file-path-content-posts-2022-2022-04-04-git-worktree-index-mdx-d4c581c42b8e91e40b5a.js.map