"use strict";(self.webpackChunkmaxpou_fr=self.webpackChunkmaxpou_fr||[]).push([[6036],{7648:function(e,t,n){n.r(t),n.d(t,{default:function(){return g}});var a=n(1151),s=n(7294);function o(e){const t=Object.assign({p:"p",h2:"h2",a:"a",span:"span",ul:"ul",li:"li",strong:"strong",blockquote:"blockquote",br:"br",em:"em"},(0,a.ah)(),e.components);return s.createElement(s.Fragment,null,s.createElement(t.p,null,"Just like React, Vue.js is a great tool to build web applications. In this article, I will share a\nproject I have been working on over the last 3 years. I will go through different technical points\nsuch as the modular architecture we use, micro-frontends, component‚Äôs state management, TypeScript,\nVue 3 and more. Keep in mind that there is not one but many ways to scaffold a Vue app. This is one\nof them."),"\n",s.createElement(t.h2,{id:"how-big",style:{position:"relative"}},s.createElement(t.a,{href:"#how-big","aria-label":"how big permalink",className:"anchor before"},s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"How big?"),"\n",s.createElement(t.p,null,"For the last 3 years, I have been working on a large vue.js application. If you‚Äôre curious about the\nproject, here are some numbers:"),"\n",s.createElement(t.ul,null,"\n",s.createElement(t.li,null,"+5k vue&js files / +650k lines of codes;"),"\n",s.createElement(t.li,null,"10 years old codebase. Vue.js landed in December 2016;"),"\n",s.createElement(t.li,null,"we have 2 repos: the app monolith + 1 monorepo (contains ~40 npm packages);"),"\n",s.createElement(t.li,null,"it‚Äôs a Single Page Application (SPA) with +30 screens."),"\n"),"\n",s.createElement(t.p,null,"As I often say: this application is not big. It‚Äôs ",s.createElement(t.strong,null,"too big"),"."),"\n",s.createElement(t.h2,{id:"modules-everywhere",style:{position:"relative"}},s.createElement(t.a,{href:"#modules-everywhere","aria-label":"modules everywhere permalink",className:"anchor before"},s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Modules everywhere"),"\n",s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 77.02702702702703%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAQACBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe2iZmP/xAAVEAEBAAAAAAAAAAAAAAAAAAABIP/aAAgBAQABBQJr/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8Bh//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/ASf/xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAaEAACAgMAAAAAAAAAAAAAAAAAASExQXGB/9oACAEBAAE/IaqBbRkc2dHZ/9oADAMBAAIAAwAAABA7H//EABYRAQEBAAAAAAAAAAAAAAAAAAEQEf/aAAgBAwEBPxBWz//EABYRAAMAAAAAAAAAAAAAAAAAAAEQIf/aAAgBAgEBPxCAv//EABsQAQADAQADAAAAAAAAAAAAAAEAESExQVGx/9oACAEBAAE/ENU2r01FR9CLrTviAJYzmQzkaTP/2Q==\'); background-size: cover; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/ad548394bcf21be0ff109e7e79b8a9e2/cbe2e/diagram.webp 148w,\n/static/ad548394bcf21be0ff109e7e79b8a9e2/3084c/diagram.webp 295w,\n/static/ad548394bcf21be0ff109e7e79b8a9e2/5ca24/diagram.webp 590w,\n/static/ad548394bcf21be0ff109e7e79b8a9e2/dad35/diagram.webp 885w,\n/static/ad548394bcf21be0ff109e7e79b8a9e2/2baf0/diagram.webp 1180w,\n/static/ad548394bcf21be0ff109e7e79b8a9e2/e3ca4/diagram.webp 1812w"\n              sizes="(max-width: 590px) 100vw, 590px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/ad548394bcf21be0ff109e7e79b8a9e2/a80bd/diagram.jpg 148w,\n/static/ad548394bcf21be0ff109e7e79b8a9e2/1c91a/diagram.jpg 295w,\n/static/ad548394bcf21be0ff109e7e79b8a9e2/1c72d/diagram.jpg 590w,\n/static/ad548394bcf21be0ff109e7e79b8a9e2/a8a14/diagram.jpg 885w,\n/static/ad548394bcf21be0ff109e7e79b8a9e2/fbd2c/diagram.jpg 1180w,\n/static/ad548394bcf21be0ff109e7e79b8a9e2/f6a0e/diagram.jpg 1812w"\n            sizes="(max-width: 590px) 100vw, 590px"\n            type="image/jpeg"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/ad548394bcf21be0ff109e7e79b8a9e2/1c72d/diagram.jpg"\n            alt="architecture diagram"\n            title=""\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n    </span>'}}),"\n",s.createElement(t.p,null,"We adopted a modularised architecture for this app. In a nutshell, 1 module = 1 business part of the\napp. And a module is something that looks like a standalone Vue application. We consider modules as\nself-contained which can potentially be exported. By the way, some are exported as npm packages\n(",s.createElement(t.a,{href:"/monorepo-pros-and-cons"},"in a monorepo"),")."),"\n",s.createElement(t.p,null,"Modules are not allowed to talk to each other‚Ä¶ in theory. If 2 modules have to communicate, we can\nuse the ",s.createElement(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent"},"CustomEvent API"),"\nfrom the browser and dispatch an event via the window object."),"\n",s.createElement(t.blockquote,null,"\n",s.createElement(t.p,null,"üôã‚Äç‚ôÄÔ∏è How do you register modules?"),"\n"),"\n",s.createElement(t.p,null,"With the vue-router. A module loosely corresponds to a single top-level URL root. With this trick,\nmodules are ",s.createElement(t.a,{href:"https://router.vuejs.org/guide/advanced/lazy-loading.html"},"‚Äúlazy loaded‚Äù"),". So users\ndon‚Äôt load the entire app when the application loads."),"\n",s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// if module is a npm package</span>\n<span class="token keyword">const</span> <span class="token function-variable function">ProductList</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">\'@company/product-list\'</span><span class="token punctuation">)</span>\n<span class="token comment">// or if the module is local</span>\n<span class="token keyword">const</span> <span class="token function-variable function">ProductList</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">\'./path/to/product-list\'</span><span class="token punctuation">)</span>\n\n\n<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token literal-property property">routes</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">\'/product-list\'</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span> ProductList <span class="token punctuation">}</span>\n    <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">\'/payments\'</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span> Payments <span class="token punctuation">}</span>\n    <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">\'/user-settings\'</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span> UserSettings <span class="token punctuation">}</span>\n    <span class="token comment">// ... other modules go here!</span>\n  <span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>'}}),"\n",s.createElement(t.p,null,s.createElement(t.strong,null,"‚òùÔ∏è Granularity is important!"),s.createElement(t.br),"\n","Among our ~40 packages, ~30 are modules. And we haven‚Äôt externalized everything yet. A single\nbusiness part of the app is sometimes splitted into multiple modules. We didn‚Äôt discuss the scope of\na module before creating it. In my opinion, we have too many modules today and a lot of them should\nbe merged. If you decide to go with this approach, don‚Äôt make the same mistake we did."),"\n",s.createElement(t.h2,{id:"micro-frontends",style:{position:"relative"}},s.createElement(t.a,{href:"#micro-frontends","aria-label":"micro frontends permalink",className:"anchor before"},s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Micro-frontends?"),"\n",s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAADM0lEQVR42i2LfVCTBRzHfzh3IQy7M+giDdR2plznFfnS1RXcdXn9Zf/YmSPYFJFhweFZHGKyBMUJcwxYY7o3NjcfeLZnCLG5MXA8CRRBnXWdlXWcf9Qp42WbL2NszW/HXd+/Pp/73Jd+GB9/xenkbEQkxNyciHNyFpvNJiYi8nzj6bDoje/R/5sY5d9lmV7tKk/6fGKOdXWzSuWzAIQD1wcMnarO7RS4dWurzm7SENEaAOt0dsulZm1b/urJNMg0ntG07C4iWpuTkyPyTfN7Lln1batt6MeJ/A7GqD6uUIgACAxuh7b69Ocv01J5X3tEylgjcldVVO6sicoYJnyU/SJ8nDuwWOYwPangmplKxWZ1Vf3Wx+VsXaSMUUXl3P5opUs2L7V3ReWu0nAlK1soc1x5WOGqIyhvR2G4h1TzjActP43AFkLq3MxkqnH6MnoeAK2/LIzJja/3HrtYiNafF6CbBb6ctKFlhofpPtA0Nfy0adoL8z/A+ZnfCSW6+pVSfRck+oM4dKUkJtHpVz7WHYGk+8OE9LIVUtNXLsnJfOXBuh0xGaNdqOz1LpX0ScOHr9WFDvf5w59wJx5KrBXz5Xb3kuyagugqusgMW5od5s1emMVD6NnkgUXggIUscJAdmm2n+S2nTn1Q8J1PbHgynB6Mj2XVPOja2fg4sG40Ecys/W3qzerISBa/MpbeSVXs1431vSr1Z6ymrcF9sU3hPKc561aqapzq1mpXh7q2X3Om6GjHpuvanXtx7437WCxG6k5eP+7u+h7LxUjdFQ+l/tjhxKP3gT9f/Yv+vpEZvmB9LZUYESbAP5MEn5HEt+uTuClMIEBPMUqL04a8t4+VluZhmCoeeQRnk37at3yDZIuDaZ1xv+BA0kv7woOC8//6SUrzw+mzN335S/GAMBQf2xha4V8KLfMb5+OjGXMx/5pwPCCYvWPOKMz+9PY26oExzYR+soDLdYETD4DNdsK96mTEIPVARQhSNsbpRXNDXqG6Nved7hMb9mhPbtirb3hhF3jKxQQ9H1TQ2gIFK8qyxd4SOWJFORemPtre4pcWtAcPbWnyHnmu/df9mUyyeP3VyO7/ACaFwHuD5YHwAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/a9a229e8d270406a797903d6189140c5/cbe2e/micro-fe.webp 148w,\n/static/a9a229e8d270406a797903d6189140c5/3084c/micro-fe.webp 295w,\n/static/a9a229e8d270406a797903d6189140c5/5ca24/micro-fe.webp 590w,\n/static/a9a229e8d270406a797903d6189140c5/dad35/micro-fe.webp 885w,\n/static/a9a229e8d270406a797903d6189140c5/2baf0/micro-fe.webp 1180w,\n/static/a9a229e8d270406a797903d6189140c5/d822c/micro-fe.webp 1788w"\n              sizes="(max-width: 590px) 100vw, 590px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/a9a229e8d270406a797903d6189140c5/12f09/micro-fe.png 148w,\n/static/a9a229e8d270406a797903d6189140c5/e4a3f/micro-fe.png 295w,\n/static/a9a229e8d270406a797903d6189140c5/fcda8/micro-fe.png 590w,\n/static/a9a229e8d270406a797903d6189140c5/efc66/micro-fe.png 885w,\n/static/a9a229e8d270406a797903d6189140c5/c83ae/micro-fe.png 1180w,\n/static/a9a229e8d270406a797903d6189140c5/41870/micro-fe.png 1788w"\n            sizes="(max-width: 590px) 100vw, 590px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/a9a229e8d270406a797903d6189140c5/fcda8/micro-fe.png"\n            alt="Comparison between classical SPA architecture and micro frontends"\n            title=""\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n    </span>'}}),"\n",s.createElement(t.p,null,"Our module architecture shows some limits. Because we only export one app, big changes are nearly\nimpossible. Let‚Äôs say we want to experiment with Vue.js 3, we will have to ensure that our few\nthousand vue files are compatible. And this scenario happens for every major change we want to do. I\ntried once to update our testing library. Out of our ~2200 tests, 500 were failing."),"\n",s.createElement(t.p,null,s.createElement(t.a,{href:"/3-tips-scaling-vue-application#tip-2-consider-micro-frontends"},"Micro frontends")," appear to be a\ngood fix for these problems. Because we could gradually update our dependencies. But nothing in life\ncomes free. The biggest downside I see is potential inconsistencies across our app. Some teams will\nuse the latest version of every tool where others will not update their dependencies. It can lead to\n‚Äúmismatched dependencies‚Äù, one team using v1 of our common component and another team using the v2.\nThis architectural style also brings interesting challenges regarding the deployment. Deploying one\napplication is very different from deploying multiple applications."),"\n",s.createElement(t.h2,{id:"webpack-5--module-federation",style:{position:"relative"}},s.createElement(t.a,{href:"#webpack-5--module-federation","aria-label":"webpack 5  module federation permalink",className:"anchor before"},s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Webpack 5 & Module federation"),"\n",s.createElement(t.blockquote,null,"\n",s.createElement(t.p,null,"Module federation allows a JavaScript application to dynamically run code from another\nbundle/build, on client and server"),"\n"),"\n",s.createElement(t.p,null,s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAACC0lEQVR42l2R3UvTYRTHn3IhRBF5E6gXWmQxL7oI+mO6KsvtIop10V3/QF0EokQEUVqpzbcCMZRhShEFNi2duuHIl9WWzpep2+/lefnEfps2OvDlOc95vud7+D5HnHhNvr7PqLowMlVAxtcycmJqVn6anpfR+LK1C8T3uSbauHl2BKpfYd+fRiqQ0aU1jzv5LeZk9mxWCySErwtHdEJtH1gKwLCVzZJd/4NjW7JYSe2rFtFO4PhbEE+NejBrimUKlu3xNrMbunjfdUmKpiGcc4NwZRgKXntR8jC8ys8cLeKJFWh+D6e7bNUe8/pR+pDnZTmHpKjvdZzaHpdLQ5K8Kr8agzEGtPYEVz1BN3BxBE6+sFTbgaDB42ml/wme6XGtpt68aR50dd71JlXCKVnmuugwrZcjUPtGu4/mPAGt9SFPli0vCV8/zrEBqC9aVhWWXQ0TKUnUJr1s3RAvCdaMg+gz6uEiZcvlz0nsaMZ+k5vZTIqjndwWzwnVdJvQ2C8T+pgxoQ8Zc3c8za3hyEqwfzh+L7zABdGG3/eMO+IxgdbPBL/sEBzNEIxsEhz9kQ+8G/ge6v+6dVX8HwhxxDuntk4xn2oitnSeuayf2Eoz6YUG0ouNzCw2MlmBhe0GO5rwE1+tEyJM1QHCUJUwprooqNcLHeX9SfYkrFuQdUrYsGHHLeXbLqjSlimoxF8Vtjld5cGLDgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/0c4a2a73ee6b1af6f7d2a343fc002fb2/cbe2e/wp5-mod-fed.webp 148w,\n/static/0c4a2a73ee6b1af6f7d2a343fc002fb2/3084c/wp5-mod-fed.webp 295w,\n/static/0c4a2a73ee6b1af6f7d2a343fc002fb2/5ca24/wp5-mod-fed.webp 590w,\n/static/0c4a2a73ee6b1af6f7d2a343fc002fb2/dad35/wp5-mod-fed.webp 885w,\n/static/0c4a2a73ee6b1af6f7d2a343fc002fb2/2baf0/wp5-mod-fed.webp 1180w,\n/static/0c4a2a73ee6b1af6f7d2a343fc002fb2/4c8e9/wp5-mod-fed.webp 1696w"\n              sizes="(max-width: 590px) 100vw, 590px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/0c4a2a73ee6b1af6f7d2a343fc002fb2/12f09/wp5-mod-fed.png 148w,\n/static/0c4a2a73ee6b1af6f7d2a343fc002fb2/e4a3f/wp5-mod-fed.png 295w,\n/static/0c4a2a73ee6b1af6f7d2a343fc002fb2/fcda8/wp5-mod-fed.png 590w,\n/static/0c4a2a73ee6b1af6f7d2a343fc002fb2/efc66/wp5-mod-fed.png 885w,\n/static/0c4a2a73ee6b1af6f7d2a343fc002fb2/c83ae/wp5-mod-fed.png 1180w,\n/static/0c4a2a73ee6b1af6f7d2a343fc002fb2/bce1e/wp5-mod-fed.png 1696w"\n            sizes="(max-width: 590px) 100vw, 590px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/0c4a2a73ee6b1af6f7d2a343fc002fb2/fcda8/wp5-mod-fed.png"\n            alt="Apps containers consume the same component library container!"\n            title=""\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n    </span>'}})," ",s.createElement(t.em,null,"The same\ncomponent library container can be shared across multiple ‚Äúapp containers‚Äù")),"\n",s.createElement(t.p,null,"If you have 2 microservices, having your favourite framework installed twice is not a big deal.\nUsers won‚Äôt perceive it. But it‚Äôs a different story on the frontend side. If 2 micro frontends use\nthe same frameworks and libraries, the user will download everything twice."),"\n",s.createElement(t.p,null,"With Webpack 5 and the module federation plugin, it‚Äôs now possible to ",s.createElement(t.em,null,"‚Äúshare code‚Äù")," between\ncontainers (or pages/builds). So if your component library is a standalone container, you can deploy\na new version of it without redeploying all the micro frontends."),"\n",s.createElement(t.p,null,s.createElement(t.em,null,"Note: at the moment, this part is still in the ‚Äúinvestigation stage‚Äù.")),"\n",s.createElement(t.h2,{id:"state-management-and-vuex",style:{position:"relative"}},s.createElement(t.a,{href:"#state-management-and-vuex","aria-label":"state management and vuex permalink",className:"anchor before"},s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"State management and Vuex"),"\n",s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 54.05405405405405%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMklEQVR42pVSTWgTQRSe/LFJ7CI2JvuXJkiD2kuh7EEoQqA3pcSD5OKlCBIQ7MFDQAWdg15WWOhmZqNrQwMiCKE9KT0IUkSPq1j7M7spMSSol0JBEU/CyEx+aKsoPhjmfW/efO97bwaAfxmkQbYlqztFCROStJrjvTgMgv+xJN4cURw3DsxujOFxtH5Frmx/PrHwdpIXsZpCwiBizmoKf6GhgYEqyW4SBZFXDK7BuSgtglCxQUO0pEcoBMEZ85mmVv2vctVf4ncaNHSIiwZAsR90aCSNNq0M+nCHwWKxEQK01zrPAwBcN82YVtmqyMif2z+a36xg1MSyYYgUgABbvGXYjv4p9zRyZ0dtf2J/oaFzHLVOKmj75vn7DZnHmap+VdXeGVMwuZVabEkDspl7DU1d+vJDetRdPthy31EWOze0p9+pvvD67LCF/lnqwccL6ZWfNOV0CgyvWvOC7rgRFZGCYhH9wPwHTgIRNWmR6VPGG5HmQXignJZAZPnupewo9s9k6+0ohSBM2Z3H74+wHPbK2cMjSdR2ReC4EQ7MbgxiPDI424N6Zu/21LXedECAEeasVYF9K14U0uAxp3V0qFCzvUkZe99kRC4yLNneQw2Td7Be51V3jWmxA6fUPIThNQjD7KHG0MbzJPZe8FE5rYyMyScZe1c5oWz7ExL2fLnineOEmJgyIi9r5bJI53NCG+ajTSsnuCU97sLZOCPU0NYTCXsrXJC1npaRtyEhcpkR/gKNJPCeyoSX/QAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/80eb99103983316511cefc0f9e936326/cbe2e/vuex.webp 148w,\n/static/80eb99103983316511cefc0f9e936326/3084c/vuex.webp 295w,\n/static/80eb99103983316511cefc0f9e936326/5ca24/vuex.webp 590w,\n/static/80eb99103983316511cefc0f9e936326/dad35/vuex.webp 885w,\n/static/80eb99103983316511cefc0f9e936326/2baf0/vuex.webp 1180w,\n/static/80eb99103983316511cefc0f9e936326/e5c51/vuex.webp 1350w"\n              sizes="(max-width: 590px) 100vw, 590px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/80eb99103983316511cefc0f9e936326/12f09/vuex.png 148w,\n/static/80eb99103983316511cefc0f9e936326/e4a3f/vuex.png 295w,\n/static/80eb99103983316511cefc0f9e936326/fcda8/vuex.png 590w,\n/static/80eb99103983316511cefc0f9e936326/efc66/vuex.png 885w,\n/static/80eb99103983316511cefc0f9e936326/c83ae/vuex.png 1180w,\n/static/80eb99103983316511cefc0f9e936326/21482/vuex.png 1350w"\n            sizes="(max-width: 590px) 100vw, 590px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/80eb99103983316511cefc0f9e936326/fcda8/vuex.png"\n            alt="Vuex"\n            title=""\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n    </span>'}}),"\n",s.createElement(t.p,null,"Vuex provides a handy way to manage the state between components. In the beginning, I really liked\nit‚Ä¶ but over time, this feeling faded out. Here are a few reasons:"),"\n",s.createElement(t.ul,null,"\n",s.createElement(t.li,null,"devs tend to put\n",s.createElement(t.a,{href:"/3-tips-scaling-vue-application#tip-3-be-kind-with-your-store-vuex"},"everything in the store"),";"),"\n",s.createElement(t.li,null,"the store makes your app\n",s.createElement(t.a,{href:"/vue-js-testing-library#testing-the-store-with-vuex"},"harder to test (integration/unit)"),";"),"\n",s.createElement(t.li,null,"scoped stores are hard to unregister. Unnecessary data can be kept in memory, sometimes causing\nstate-sync issues;"),"\n",s.createElement(t.li,null,"if you have +10 mutation when page load, time travel (via devtools) does not work well;"),"\n",s.createElement(t.li,null,"dead code in state/mutation/actions is hard to identify."),"\n"),"\n",s.createElement(t.p,null,"I mentioned earlier, we splitted our app into small modules. Since our modules are like a small\n",s.createElement(t.em,null,"vue-cli")," app with a few pages only, ",s.createElement(t.strong,null,"controlling the pages state with a Vuex store does not make a\nlot of sense at the end"),"."),"\n",s.createElement(t.p,null,"I stopped using Vuex in modules, something like 2y ago. So far, so good. I found the code more\nreadable and more maintainable. However, I still use it for high-level stuff like i18n and user\nsettings."),"\n",s.createElement(t.h2,{id:"what-about-typescript",style:{position:"relative"}},s.createElement(t.a,{href:"#what-about-typescript","aria-label":"what about typescript permalink",className:"anchor before"},s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"What about TypeScript?"),"\n",s.createElement(t.p,null,"A few years ago, a colleague wanted to introduce TypeScript. After many debates, we ended up with\nthis decision: ‚ÄúTS is cool and static type checking can be beneficial for such a big codebase.\nHowever, ",s.createElement(t.strong,null,"adding it would require too much effort"),". The return of investment is not worthy‚Äù."),"\n",s.createElement(t.p,null,"It might change with Vue 3. Integration with this language looks very promising!"),"\n",s.createElement(t.h2,{id:"what-about-vue-3",style:{position:"relative"}},s.createElement(t.a,{href:"#what-about-vue-3","aria-label":"what about vue 3 permalink",className:"anchor before"},s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"What about Vue 3?"),"\n",s.createElement(t.p,null,"I see two main reasons to think about Vue.js 3: Performance improvements and Composition API."),"\n",s.createElement(t.ul,null,"\n",s.createElement(t.li,null,"\n",s.createElement(t.p,null,s.createElement(t.strong,null,"Performance improvements"),": it‚Äôs (almost) always a good thing to thrive for performances. But in\nthis case, I don‚Äôt think it will solve our problems. It‚Äôs like if you replace your car with a\nFerrari to get your coffee at the end of the road. But the thing is, we live on the 6th floor with\nno elevator.",s.createElement(t.br),"\n","Our bottleneck is not in the component rendering but in the amount of code the browser has to\nparse before rendering the page. Deleting code is not as fancy as bumping a framework version."),"\n"),"\n",s.createElement(t.li,null,"\n",s.createElement(t.p,null,s.createElement(t.strong,null,"Composition API")," (Hooks made in Vue): The feature we were all looking for, when React added\nhooks ~2y ago. In a nutshell, the Composition API provides a lot of value when you want to reuse\nsome logic or when you struggle to read large components. Much like with Mixins, you can extract\ncomponent logic into a file. Then you can ",s.createElement(t.em,null,"compose")," your component with this logic. If you, like\nme, can‚Äôt wait to use it, there‚Äôs a ",s.createElement(t.a,{href:"https://github.com/vuejs/composition-api"},"plugin for Vue 2.x"),"\nwhich seems to be stable enough to go to\n",s.createElement(t.a,{href:"https://github.com/vuejs/composition-api/issues/527"},"production"),"."),"\n"),"\n"),"\n",s.createElement(t.p,null,"For these reasons, ",s.createElement(t.em,null,"I don‚Äôt think")," we will see Vue.js 3 this year. But the Composition API will\nprobably arrive soon in the codebase."),"\n",s.createElement(t.p,null,s.createElement(t.em,null,"Edit: Vue team is working on\n",s.createElement(t.a,{href:"https://twitter.com/vuejs/status/1388144585600274433"},"compatibility bridges")," between versions 2\nand 3. It might change!")),"\n",s.createElement(t.h2,{id:"component-library-and-storybook",style:{position:"relative"}},s.createElement(t.a,{href:"#component-library-and-storybook","aria-label":"component library and storybook permalink",className:"anchor before"},s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Component library and Storybook"),"\n",s.createElement(t.p,null,s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 53.37837837837838%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABqElEQVR42mVSW44cMQjs+98h/znGniEfyXeU3c1Ek374DQa7Iuje0aziFrIb46IoWPYQQdSRqeN37GjcISrg3t0qMboIdAz0fvqJ+XF3S4LEin79Lz/eA36midfA+PV+QykVtuYcmHNizAn7cJn5mLvvjRgptzNmDrAIlq/fM758K3h5E8CcxJhj4HnNeUKOMaCqaETOqPDT/ZwQHVhu9ztqzh5spYRth4p4oPn6dT6ZsQPmXFBqxRz6AMMDcIvYM6H1cZVxZjeWnRmllLN0VYSYPInJknJGpvE/4H0PiJVRWZzBth8IITpQygV7CM7GLKbszWiteewHiU+Ab39WbKmikkBEcMTopRsTexRidL9rVhrGmJ6MHBBXs84lOrHcj4jCA62rZ1+3HUcIPiKtkZ/tsdl+nOdaG2JKaK0625wz2KSSgWUNGYUV1WZJugeaPnJ1czsOEHcflXXfQcQgIk+eUsK2bQ6oKuiinwEt2AbdzGYsl+qMS21uf9fN2Rmrs3nssnjTTKIuWI7ckFm9ZNPKxNdxgjtTUc+cGqFyh+p4DP3zDH405R+PwVpNtgug9wAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/66f2a6aec4d5c239309ba16f7546972b/cbe2e/storybook.webp 148w,\n/static/66f2a6aec4d5c239309ba16f7546972b/3084c/storybook.webp 295w,\n/static/66f2a6aec4d5c239309ba16f7546972b/5ca24/storybook.webp 590w,\n/static/66f2a6aec4d5c239309ba16f7546972b/dad35/storybook.webp 885w,\n/static/66f2a6aec4d5c239309ba16f7546972b/2baf0/storybook.webp 1180w,\n/static/66f2a6aec4d5c239309ba16f7546972b/c3872/storybook.webp 2416w"\n              sizes="(max-width: 590px) 100vw, 590px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/66f2a6aec4d5c239309ba16f7546972b/12f09/storybook.png 148w,\n/static/66f2a6aec4d5c239309ba16f7546972b/e4a3f/storybook.png 295w,\n/static/66f2a6aec4d5c239309ba16f7546972b/fcda8/storybook.png 590w,\n/static/66f2a6aec4d5c239309ba16f7546972b/efc66/storybook.png 885w,\n/static/66f2a6aec4d5c239309ba16f7546972b/c83ae/storybook.png 1180w,\n/static/66f2a6aec4d5c239309ba16f7546972b/80521/storybook.png 2416w"\n            sizes="(max-width: 590px) 100vw, 590px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/66f2a6aec4d5c239309ba16f7546972b/fcda8/storybook.png"\n            alt="Storybook example"\n            title=""\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n    </span>'}})," ",s.createElement(t.em,null,"Storybook is a great bridge between the frontend and the UX\nteam. We heavily rely on this tool and so far, we‚Äôre very happy to use it.")),"\n",s.createElement(t.p,null,"Even if you start from an existing component library, you might have to build your reusable\ncomponents. In one place we put all our components, including very specific components into our\napplication. I tend to consider this package as an ‚Äúopen-source package‚Äù, something that anybody\ncould reuse."),"\n",s.createElement(t.p,null,"When we have to build a new screen it‚Äôs pretty much like doing a lego construction. There‚Äôs a kind\nof component box and developers pick what they need. Most of the time, writing CSS is not needed."),"\n",s.createElement(t.h2,{id:"testing",style:{position:"relative"}},s.createElement(t.a,{href:"#testing","aria-label":"testing permalink",className:"anchor before"},s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Testing"),"\n",s.createElement(t.p,null,"We have 3 different types of tests:"),"\n",s.createElement(t.ul,null,"\n",s.createElement(t.li,null,s.createElement(t.strong,null,"Static code analysis")," (with ESLint): We created a set of rules on the top of Airbnb‚Äôs config.\nThis configuration is used everywhere in the app. It prevents us from pushing dead or misformatted\ncode to the main branch. By the way, having a shareable ESlint config is a good way to\n",s.createElement(t.a,{href:"/lesson-learned-maintaining-large-vue-js-codebase#close-the-door-on-bikeshedding"},"close the door on bikeshedding"),"!"),"\n",s.createElement(t.li,null,s.createElement(t.strong,null,"Unit tests")," (with Jest): Less than 10% of our ",s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">xxx.test.js</code>'}})," are unit tests. It‚Äôs mostly used to\ntest the business part of the app. Because writing integration tests would require too many\nscenarios and test files would end up being unnecessarily verbose. Also, integration tests are\nslower than unit tests. By the way, we don‚Äôt unit test components or Vuex stores."),"\n",s.createElement(t.li,null,s.createElement(t.strong,null,"Integration tests")," (with Vue Testing Library): where the magic happens. We really like this\nlibrary, because it provides ",s.createElement(t.a,{href:"/vue-js-testing-library"},"a very straightforward way")," to test our\napp."),"\n"),"\n",s.createElement(t.p,null,"At the moment, we have a total of ~3100 unit&integration tests."))}var i=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,a.ah)(),e.components);return t?s.createElement(t,e,s.createElement(o,e)):o(e)},r=n(4222),c=n(418),l=n(4529),p=n(7953),d=n(4849),m=n(5536),u=n(2404);function h(e){let{data:t,pageContext:n,children:a,location:o}=e;const i=t.post,{previous:h,next:g}=n;return s.createElement(r.Z,{location:o},s.createElement(m.Z,{title:i.frontmatter.title,description:i.frontmatter.description||i.excerpt,cover:i.frontmatter.cover&&i.frontmatter.cover.publicURL,imageShare:i.frontmatter.imageShare&&i.frontmatter.imageShare.publicURL,lang:i.frontmatter.language,translations:i.frontmatter.translations,path:i.frontmatter.slug,isBlogPost:!0}),s.createElement(l.Z,{heroImg:i.frontmatter.cover,title:i.frontmatter.title}),s.createElement(c.Z,null,s.createElement(p.Z,{post:i},a)),s.createElement(c.Z,{as:"aside"},s.createElement(u.Z,{slug:i.frontmatter.slug,title:i.frontmatter.title,redditPostId:i.frontmatter.redditPostId})),s.createElement(d.Z,{previous:h,next:g}))}function g(e){return s.createElement(h,e,s.createElement(i,e))}}}]);
//# sourceMappingURL=component---src-templates-blog-post-js-content-file-path-content-posts-2021-2021-05-27-vue-js-module-architecture-index-mdx-25ebc090683d5540a5a3.js.map